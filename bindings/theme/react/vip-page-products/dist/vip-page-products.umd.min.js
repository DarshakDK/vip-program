!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("React"),require("helmetModule"),require("sharedUtilsLibrary")):"function"==typeof define&&define.amd?define("extension",["React","helmetModule","sharedUtilsLibrary"],t):"object"==typeof exports?exports.extension=t(require("React"),require("helmetModule"),require("sharedUtilsLibrary")):e.extension=t(e.React,e.helmetModule,e.sharedUtilsLibrary)}("undefined"!=typeof self?self:this,((e,t,o)=>(()=>{"use strict";var n={173:e=>{e.exports=o},333:e=>{e.exports=t},883:t=>{t.exports=e}},r={};function a(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,a),o.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var c={};a.r(c),a.d(c,{default:()=>y});var l={};a.r(l),a.d(l,{Component:()=>f,GET_PRODUCT_DETAILS:()=>g,settings:()=>h});var s=a(883),i=a.n(s),d=a(173),u=a(333);const p={product:"gONOQ",container:"aQaT4"};function m({product:e}){return i().createElement("div",{className:p.product},e.media?.map((e=>i().createElement("img",{src:e.url,alt:e.alt}))),i().createElement("h1",null,e.name),i().createElement("h2",null,e.slug))}const g="query($slug: String!)  {\n  product(slug: $slug) {\n    brand {\n      name\n      uid\n    }\n    color\n    item_code\n    item_type\n    uid\n    media {\n      alt\n      type\n      url\n    }\n    name\n    price {\n      effective {\n        currency_code\n        currency_symbol\n        max\n        min\n      }\n      marked {\n        currency_code\n        currency_symbol\n        max\n        min\n      }\n    }\n    rating\n    rating_count\n    short_description\n    slug\n  }\n}";function f({title:e="VIP Products"}){const t=(0,d.useFPI)(),o=t.store.getState();console.log("state draft benefits 3",o,t.getters.THEME(o)),useGlobalStore(t.getters.LOGGED_IN);const[n,r]=(0,s.useState)([]),[a,c]=(0,s.useState)(!1),[l,f]=(0,s.useState)(null),[h,y]=(0,s.useState)(!0),[b,E]=(0,s.useState)(null),v=t.getters.THEME(o)?.application_id||"683178a4b531714af0e04a53",P=t.getters.THEME(o)?.company_id||"10253",_=useGlobalStore(t.getters.USER_DATA)?.user_id||"682c158a3d88c46a01efac53",w=async e=>{try{console.log(`Fetching details for item code: ${e}`);const o={slug:e},n=await t.executeGQL(g,o);return n?.data?.product?(console.log(`Product details for ${e}:`,n.data.product),n.data.product):(console.warn(`No product found for item code: ${e}`),null)}catch(t){return console.error(`Error fetching details for product ${e}:`,t),null}};return(0,s.useEffect)((()=>{(async()=>{try{y(!0),E(null),console.log("Fetching campaign data...");const e=await(async()=>{try{const e=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?companyId=${P}&queryType=validate&applicationId=${v}&module=campaigns`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to fetch campaign data");const t=await e.json();return console.log("Campaign data:",t),t}catch(e){throw console.error("Error fetching campaign data:",e),e}})();if(e.success&&e.data.length>0){const t=e.data.filter((e=>(e=>{const t=new Date,o=new Date(e.startDate),n=new Date(e.endDate);return"CUSTOM_PROMOTIONS"!==e.type&&t>=o&&t<=n})(e)));if(t.length>0){console.log("Active campaigns found:",t);const e=t[0];if(f(e),e.products&&e.products.length>0){console.log("VIP Product item codes:",e.products.map((e=>e.item_code)));const t=await(async e=>{const t=[];for(const o of e)if(o.item_code){const e=await w(o.item_code);e&&t.push(e)}return t})(e.products);r(t)}console.log("Validating VIP user...");const o=await(async()=>{try{const e=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?module=users&companyId=${P}&queryType=validate&id=${_}&applicationId=${v}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to validate VIP user");const t=await e.json();return console.log("VIP user validation:",t),t}catch(e){throw console.error("Error validating VIP user:",e),e}})();o.success&&o.data&&o.data.length>0?(console.log("VIP user validation successful:",o.data),c(!0)):(console.log("User is not a VIP member"),c(!1))}else console.log("No active campaigns found"),f(null)}else console.log("No campaigns found"),f(null)}catch(e){console.error("Error in VIP validation process:",e),E(e.message)}finally{y(!1)}})()}),[]),h?i().createElement("h2",null,"Loading products..."):b?i().createElement("h2",null,"Error: ",b):n.length?i().createElement("div",null,i().createElement(u.Helmet,null,i().createElement("title",null,e)),i().createElement("h1",null,"VIP Products"),!a&&l&&i().createElement("div",{className:p.vipMessage||""},i().createElement("p",null,"These products will be available once you buy the membership.")),i().createElement("div",{className:p.container},n.map((e=>(console.log("Product item code:",e.item_code||"No item code available"),i().createElement(m,{product:e,key:e.slug||e.item_code,isVipOnly:!a})))))):i().createElement("h2",null,"No VIP Products Found")}f.serverFetch=({fpi:e})=>Promise.resolve();const h={label:"VIP Page Products Section",name:"vip-page-products-section",props:[{id:"title",label:"Page Title",type:"text",default:"VIP Products",info:"Set the page title for the product list."}],blocks:[]},y={"product-list":{...l}};return c})()));