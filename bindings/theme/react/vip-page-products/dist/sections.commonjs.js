(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:()=>d});var o={};e.r(o),e.d(o,{Component:()=>s,GET_PRODUCT_DETAILS:()=>l,settings:()=>i});const n=require("fs");var a=e.n(n);const r={product:"gONOQ",container:"aQaT4"};function c({product:e}){return a().createElement("div",{className:r.product},e.media?.map((e=>a().createElement("img",{src:e.url,alt:e.alt}))),a().createElement("h1",null,e.name),a().createElement("h2",null,e.slug))}const l="query($slug: String!)  {\n  product(slug: $slug) {\n    brand {\n      name\n      uid\n    }\n    color\n    item_code\n    item_type\n    uid\n    media {\n      alt\n      type\n      url\n    }\n    name\n    price {\n      effective {\n        currency_code\n        currency_symbol\n        max\n        min\n      }\n      marked {\n        currency_code\n        currency_symbol\n        max\n        min\n      }\n    }\n    rating\n    rating_count\n    short_description\n    slug\n  }\n}";function s({title:e="VIP Products"}){const t=(0,n.useFPI)(),o=t.store.getState();console.log("state draft benefits 3",o,t.getters.THEME(o)),useGlobalStore(t.getters.LOGGED_IN);const[s,i]=(0,n.useState)([]),[d,u]=(0,n.useState)(!1),[p,m]=(0,n.useState)(null),[g,f]=(0,n.useState)(!0),[h,y]=(0,n.useState)(null),E=t.getters.THEME(o)?.application_id||"683178a4b531714af0e04a53",P=t.getters.THEME(o)?.company_id||"10253",b=useGlobalStore(t.getters.USER_DATA)?.user_id||"682c158a3d88c46a01efac53",v=async e=>{try{console.log(`Fetching details for item code: ${e}`);const o={slug:e},n=await t.executeGQL(l,o);return n?.data?.product?(console.log(`Product details for ${e}:`,n.data.product),n.data.product):(console.warn(`No product found for item code: ${e}`),null)}catch(t){return console.error(`Error fetching details for product ${e}:`,t),null}};return(0,n.useEffect)((()=>{(async()=>{try{f(!0),y(null),console.log("Fetching campaign data...");const e=await(async()=>{try{const e=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?companyId=${P}&queryType=validate&applicationId=${E}&module=campaigns`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to fetch campaign data");const t=await e.json();return console.log("Campaign data:",t),t}catch(e){throw console.error("Error fetching campaign data:",e),e}})();if(e.success&&e.data.length>0){const t=e.data.filter((e=>(e=>{const t=new Date,o=new Date(e.startDate),n=new Date(e.endDate);return"CUSTOM_PROMOTIONS"!==e.type&&t>=o&&t<=n})(e)));if(t.length>0){console.log("Active campaigns found:",t);const e=t[0];if(m(e),e.products&&e.products.length>0){console.log("VIP Product item codes:",e.products.map((e=>e.item_code)));const t=await(async e=>{const t=[];for(const o of e)if(o.item_code){const e=await v(o.item_code);e&&t.push(e)}return t})(e.products);i(t)}console.log("Validating VIP user...");const o=await(async()=>{try{const e=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?module=users&companyId=${P}&queryType=validate&id=${b}&applicationId=${E}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to validate VIP user");const t=await e.json();return console.log("VIP user validation:",t),t}catch(e){throw console.error("Error validating VIP user:",e),e}})();o.success&&o.data&&o.data.length>0?(console.log("VIP user validation successful:",o.data),u(!0)):(console.log("User is not a VIP member"),u(!1))}else console.log("No active campaigns found"),m(null)}else console.log("No campaigns found"),m(null)}catch(e){console.error("Error in VIP validation process:",e),y(e.message)}finally{f(!1)}})()}),[]),g?a().createElement("h2",null,"Loading products..."):h?a().createElement("h2",null,"Error: ",h):s.length?a().createElement("div",null,a().createElement(n.Helmet,null,a().createElement("title",null,e)),a().createElement("h1",null,"VIP Products"),!d&&p&&a().createElement("div",{className:r.vipMessage||""},a().createElement("p",null,"These products will be available once you buy the membership.")),a().createElement("div",{className:r.container},s.map((e=>(console.log("Product item code:",e.item_code||"No item code available"),a().createElement(c,{product:e,key:e.slug||e.item_code,isVipOnly:!d})))))):a().createElement("h2",null,"No VIP Products Found")}s.serverFetch=({fpi:e})=>Promise.resolve();const i={label:"VIP Page Products Section",name:"vip-page-products-section",props:[{id:"title",label:"Page Title",type:"text",default:"VIP Products",info:"Set the page title for the product list."}],blocks:[]},d={"product-list":{...o}};exports.sections=t})();